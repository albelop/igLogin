!function(){"use strict";angular.module("ig.login",["ui.router","angular-jwt","cryptojs"]),angular.module("ig.login").config(["$httpProvider","jwtInterceptorProvider","igLoginProvider",function(o,t,e){t.tokenGetter=e.getToken,o.interceptors.push("jwtInterceptor")}]),angular.module("ig.login").run(["$rootScope","$state","igLogin",function(o,t,e){o.$on("access:logout",function(){t.go("login")}),o.$on("access:login",function(){t.previous&&!t.previous["abstract"]?t.go(t.previous,t.previousParams):t.go("home")}),o.$on("$stateChangeStart",function(o,t){"login"!==t.name&&(e.checkToken()||o.preventDefault())})}])}(),function(){"use strict";angular.module("cryptojs",[]).factory("CryptoJS",["$window",function(o){return o.CryptoJS}])}(),function(){"use strict";angular.module("ig.login").controller("igLoginCtrl",["$scope","igLogin",function(o,t){this.getUser=t.getUserData,this.get=function(e,n,r){r=r||!1,t.get(e,n).then(function(o){t.login(o.data,r)},function(t){o.error=t.data})}}])}(),function(){"use strict";angular.module("ig.login").directive("igLoginForm",function(){return{restrict:"EA",template:'<form ng-submit="login.get(username, password,keeplogged)"><div class="form-group"><label for="username">Usuario</label><input type="text" ng-model="username" class="form-control col-sm-12" id="username" placeholder="Introduzca el nombre de usuario"  required></div><div class="form-group"><label for="password">Contraseña</label><input type="password" class="form-control col-sm-12" id="password" placeholder="Contraseña" ng-model="password" required></div><div class="form-group"><input type="checkbox" ng-model="loginData.keeplogged"> No cerrar sesión</div><button type="submit" class="btn btn-block btn-default">Entrar</button><div class="alert alert-danger" ng-if="error">{{error}}</div></form>',controller:"igLoginCtrl",controllerAs:"login"}}),angular.module("ig.login").directive("igLogout",function(){return{restrict:"A",controller:["$scope","igLogin",function(o,t){o.logOut=function(){t.logout()}}],compile:function(){return{pre:function(o,t,e){e.ngClick="logOut()"}}}}})}(),function(){"use strict";angular.module("ig.login").provider("igLogin",function(){var o={path:"../api/login"},t=function(t){o=t},e=function(){return o},n=function(o){localStorage.setItem("id_token",o)},r=function(){return localStorage.getItem("id_token")},i=function(o){localStorage.setItem("keeplogged",o)},a=function(){return localStorage.getItem("keeplogged")};this.getToken=r,this.setParams=t,this.$get=["$http","jwtHelper","$rootScope","CryptoJS",function(o,t,c,u){var l={};return l.login=function(o,t){n(o),i(t),c.$broadcast("access:login")},l.logout=function(){localStorage.removeItem("id_token"),localStorage.removeItem("keeplogged"),c.$broadcast("access:logout")},l.checkToken=function(){var o=r(),e=!0;return(!o||t.isTokenExpired(o))&&(c.$broadcast("access:logout"),e=!1),e},l.checkRemember=function(){var o="true"===a(),t=!0;return o&&(c.$broadcast("access:logout"),t=!1),t},l.getUserData=function(){var o=r(),e={};return o&&(e=t.decodeToken(o)),e},l.get=function(t,n){var r=u.SHA256(n),i=btoa(t+":"+r);return o.get(e().path,{headers:{Authorization:"Basic "+i}})},l}]})}();